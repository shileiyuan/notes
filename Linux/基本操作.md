[TOC]



## 基本操作

### cd

1. `cd 或 cd ~ ` ：代表回到用户主目录去
2. `cd - `： 代表回到刚才那个目录去



### ls

| 选项 | 描述                                       |
| ---- | ------------------------------------------ |
| -a   | 显示全部文件，连同隐藏文件一起显示         |
| -d   | 仅列出目录本身，而不是列出目录内的文件数据 |
| -h   | 将文件容量已人类易读的方式列出来           |
| -l   | 列出长数据串，包含文件的属性与权限等数据   |
| -t   | 依时间排序，而不是文件名                   |
| -i   | 列出inode号码                              |
| -S   | 按文件大小对结果排序                       |

```bash
# 以可读的方式显示文件的详细信息
ls -alh

# -rw-r--r--    1 ysl  staff   1.3M  8 21 21:23 playground.tar

# -rw-r--r--: 文件权限
# 1: 文件硬链接数目
# ysl： 文件所有者的用户名
# staff： 文件所属用户组的名称
# 1.3M： 文件大小
# 8 21 21:23： 上次修改文件的日期和时间
# playground.tar: 文件名

```



### umask

指定当前用户在新建文件或目录时的权限默认值

```bash
umask
# 0022  只看后三位数字就好，代表的是所有者、所在组、其他组的权限拿掉的值

umask -S
# u=rwx, g=rx, o=rx

# 初创文件的最大权限是666，减去掩码022，表示初创文件的权限是644，即 -rw-r--r--
# 初创目录的最大权限是777，减去掩码022，表示初创目录的权限是755，即 drwxr-xr-x
```



### shutdown

```bash
# 立即关机
shutdown -h now

# 立即重启
shutdown -r now

```



## 小工具

1. date
2. cal
3. df：查看磁盘的可用空间




## 文件和目录

### 文件或目录的权限

`-rw-r--r--`

第一个字符表示文件的类型。 `- `表示是一个普通文件，`d` 表示目录， `l` 表示链接文件。

紧接着的三个字符表示文件所有者的权限，再接着的三个字符表示文件所属组中成员的权限。

最后三个字符表示其他所有人的访问权限。

**rwx代表的数值大小：**
`r: 4   w: 2   x: 1`

**对文件来说权限的意义：**
r：可读取文件内容
w：可修改文件内容（但不能删除该文件）
x：该文件具有可以被系统执行的权限

**对目录来说权限的意义：**
r：可以查看目录包含的文件名
w：具有更改该目录结构列表的权限，即允许在目录中新建、移动、删除文件或子目录
x：是否允许cd到该目录下

**目录一般要有r和x权限：755**
**文件只要有r权限就好了：744**



### 改变文件或目录的权限

```bash
# -R 表示连同目录下的所有文件都会更改
chmod [-R] 777 file|dir
```



### 改变文件所有者

```bash
chown [-R] 账号名称:组名 文件或目录
chown root:root install.log
```



### cp

复制文件，默认会覆盖掉同名文件

| 选项 | 描述                                                         |
| ---- | ------------------------------------------------------------ |
| -a   | 相当于-pdr                                                   |
| -p   | 连同文件的属性一起复制过去，而非使用默认属性                 |
| -d   | 若源文件为连接文件，则复制连接文件而非文件本身               |
| -r   | 递归持续复制，用于目录的复制行为                             |
| -l   | 复制成为硬链接文件                                           |
| -s   | 复制成为软链接文件                                           |
| -u   | 将文件从一个目录复制到另一个目录时，只会复制那些目标目录中不存在的文件或是目标目录中相应文件的更新文件 |
| -i   | 在覆盖一个已存在文件前，提示用户进行确认。如果没有指定该选项，cp会默认覆盖文件 |



```bash
# 将file1复制到file2。如果file2存在，则会被file1的内容覆盖。如果file2不存在，则创建file2
cp file1 file2

# 同上，区别在于当file2存在时，覆盖之前会通知用户确认
cp -i file1 file2

# 将file1和file2复制到dir1目录里，dir1必须已经存在
cp file1 file2 dir1

# 将dir1中的所有文件复制到dir2中，dir2必须已经存在
cp dir1/* dir2

# 将dir1目录（及其内容）复制到dir2目录中。如果dir2不存在，则创建dir2，且包含与dir1目录相同的内容
cp -r dir1 dir2
```



### mv

移动文件与目录或重命名

```bash
mv source destination
```

### ln

所有文件都有一个inode号码，指向一块内存

硬链接就是inode号码与原文件相同，所以它们指向了同一块内存

硬链接不能引用与该链接不在同一磁盘分区的文件

硬链接无法引用目录。

软链接就是inode号码与原文件不同，它的指针指向了原文件所在的路径，就像windows的快捷方式一样

```bash
# 创建文件
touch myfile && echo 'This is a plain text file' > myfile
# 给myfile创建硬链接 hard
ln myfile hard
# 给myfile创建软链接 soft
ln -s myfile soft
```



### 获取文件或目录名

```bash
#  取得最后的文件名  network
basename /etc/sysconfig/network

# 取得目录名 /etc/sysconfig
dirname /etc/sysconfig/network
```

### mkdir

创建目录

`-m`:  创建目录的时候，顺便设置目录的权限  `mkdir -m 711 test`

`-p`:  递归的创建所有目录  `mkdir -p test1/test2/test3`

```bash
# 创建dir-001 ~ dir-100 共100个目录
mkdir -p playground/dir-{00{1..9}, 0{10..99}, {100}}
# 再在每个目录下创建26个文件
touch playground/dir-{00{1..9}, 0{10..99}, {100}}/file-{A..Z}
```

###  rmdir

删除目录

`-p`：连同上层空的目录也一起删除 `rmdir -p test1/test2`



### alias

```bash
# 创建别名
alias foo='cd /usr; ls; cd -'

# 删除别名
unalias foo
```



## 查看文件内容

### cat

```bash
# -n: 对行编号
cat -n foo.txt

# 清空文件
cat /dev/null > foo.txt
```

### tac

由最后一行到第一行反向显示

### less

pageDown或空格键：下一页
pageUP或b： 上一页
enter： 下一行
G：跳转到文本文件的末尾
g：跳转到文本文件的开头
/字符串： 向下查询字符串 
?字符串： 向上查询字符串
n：重复前一个查询
N：反向重复前一个查询
q： 离开less这个程序



### head

```bash
# 显示前20行，默认显示前10行
head -n 20 /etc/man.config
```

### tail

 显示后面几行

如果查看的文件一直在被写入，可以加入-f参数，就会一直检测该文件，直到你按下ctrl+c才会离开tail检测

```bash
# 显示100行及以后的数据
tail -n +100 /etc/man.config
```



## 进程

进程ID是按递增的顺序来分配的，init进程的pid始终为1。

### ps

```bash
# 查看ps命令被执行时刻机器状态的一个快照
ps
ps x
ps aux
```

ps命令字段说明：

| 标题  | 含义                                                         |
| ----- | ------------------------------------------------------------ |
| USER  | 用户ID。表示该进程的所有者                                   |
| %CPU  | CPU使用百分比                                                |
| %MEM  | 内存使用百分比                                               |
| VSZ   | 虚拟耗用内存大小                                             |
| RSS   | 实际使用的内存大小。进程使用的无物理内存（RAM）大小（以KB为单位） |
| START | 进程开启的时间。如果数值超过24小时，那么将使用日期来显示。   |
| STAT  | 是state的缩写，表示的该进程的当前状态                        |
| TIME  | 表示该进程消耗的CPU时间总和                                  |

STAT状态说明：

| 状态 | 含义                                                         |
| ---- | ------------------------------------------------------------ |
| R    | 运行状态。表示进程正在运行或准备运行                         |
| S    | 睡眠状态。进程不在运行，而是在等待某事件发生，如键盘输入或者收到网络报文 |
| D    | 不可中断的睡眠状态。进程在等待IO操作，如硬盘驱动             |
| T    | 暂停状态。进程被指示暂停（后续还可继续运行）                 |
| Z    | 无效或者僵尸进程。子进程被终止，但是还没有被其父进程彻底释放掉 |
| <    | 高优先级进程。进程可以被赋予更多的重要性，分配更多的CPU时间。 |
| N    | 低优先级进程。只有在其他更高优先级的进程使用完处理器以后才能够获得使用处理器的时间。 |

```bash
# 使程序在后台运行
xlogo &

# 查看从该终端运行的所有作业
jobs

# 使进程回到前台, 1指的是jobs返回的编号
fg %1  

# 使进程回到后台
bg %1

# 终止进程： Ctrl + C
# 暂停进程： Ctrl + Z

# 杀死进程
kill PID

# 杀死所有进程
killall xlogo
```





## 用户管理

**密码文件： /etc/passwd**

`root:x:0:0:root:/root:/bin/bash`

`slade:x:1000:1000:Slade:/home/slade:/bin/bash`

用户的7中属性，用:隔开

1， 用户名：uid 唯一

2， 口令：是否需要口令， x（如果没有x，则不用口令就能登录）

3， 用户ID：每个用户拥有的唯一的识别号码。如root为0号，系统用户为1-499号，普通用户从500开始，系统只靠ID号来识别用户

4， 组ID（gid）：默认和uid相同

5，全称：附加信息，可为空

6，主目录： home

7，shell：指定用户所使用的shell，默认为bash（/bin/bash）



### 目录说明

| 目录        | 内容                                                         |
| ----------- | ------------------------------------------------------------ |
| /           | 根目录                                                       |
| /bin        | 包含系统启动和运行所必须的二进制文件                         |
| /boot       | 包含Linux内核、最初的RAM磁盘映像，以及启动加载程序           |
| /dev        | 内核将它能够识别的所有设备存放在这个目录里                   |
| /etc        | 包含所有系统层面的配置文件，同时也包含了一系列shell脚本。有趣的文件： `/etc/crontab` : 该文件定义了自动化任务运行的时间； `/etc/fstab`: 存储设备及相关挂载点的列表； `/etc/passwd`: 用户账户列表 |
| /home       | 每个用户都会在/home目录下拥有一个属于自己的目录，普通用户只能在自己的主目录中创建文件 |
| /lib        | 包含核心系统程序使用的共享文件                               |
| /lost+found | 用于恢复分区                                                 |
| /media      | 包含可移除媒体设备的挂载点，比如USB驱动、CD-ROM等。这些设备在插入计算机后，会自动挂在到这个目录节点下 |
| /mnt        | 在早期Linux系统中，该目录包含手动挂载的可移除设备的挂接点    |
| /opt        | 主要用来存放可能安装在系统中的商业软件                       |
| /proc       | 是一个Linux内核维护的虚拟文件系统                            |
| /root       | root账户的主目录                                             |
| /sbin       | 该目录放置系统二进制文件。这些程序执行重要的系统任务，这些任务通常是为超级用户预留的 |
| /tmp        | 存放临时文件                                                 |
| /usr        | 包含普通用户使用的所有程序和相关文件                         |
| /usr/bin    | 包含一些Linux发行版安装的可执行程序，该目录通常会存储成千上万个程序 |
| /usr/lib    | /usr/bin目录中的程序使用的共享库                             |
| /usr/local  | 存放的是并非系统自带却打算让系统使用的程序的安装目录         |
| /usr/bin    | 包含更多的系统管理程序                                       |
| /usr/share  | 包含了/usr/bin中的程序使用的全部共享数据，包括默认配置文件、图标、屏幕背景、音频文件等 |
| /var        | 存储一些可变的数据，比如各种数据库、假脱机文件、用户邮件等   |
| /var/log    | 这里包含的日志文件记录了各种系统活动。                       |





### 通配符

| 通配符        | 匹配项                           |
| ------------- | -------------------------------- |
| *             | 匹配任意多个字符（包括0个和1个） |
| ？            | 匹配任一单个字符（不包括0个）    |
| [characters]  | 匹配任意一个属于字符集中的字符   |
| [!characters] | 匹配任意一个不属于字符集中的字符 |
| [[:class:]]   | 匹配任意个属于指定字符类中的字符 |

### 常用的字符类

| 字符类    | 匹配项                 |
| --------- | ---------------------- |
| [:alnum:] | 匹配任意一个字母或数字 |
| [:alpha:] | 匹配任意一个字母       |
| [:digit:] | 匹配任意一个数字       |
| [:lower:] | 匹配任意个小写字母     |
| [:upper:]    | 匹配任意一个大写字母 |



### 重定向

文件描述符： 标准输入文件、标准输出文件和标准错误文件的文件描述符分别是0、1和2

```bash
# 重定向标准错误
ls -l /bin/usr 2> ls-error.txt

# 将标准输出和标准错误重定向到同一个文件
ls -l /bin/usr &> ls-output.txt

```

 ### 管道

管道的作用是将命令从标准输入读取的数据，发送到标准输出





## 环境

set命令会同时显示shell变量和环境变量，而printenv只会显示环境变量



## 软件安装

```bash
# 安装vim
apt-get update; apt-get install vim;

# 安装nodejs
apt-get update; apt-get install nodejs;

# 查看已安装的软件包
dpkg --list

```

